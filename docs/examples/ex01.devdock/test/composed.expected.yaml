%YAML 1.1
# ^-- Some parsers don't accept v1.2 yet, e.g. GitLab CI.
# -*- coding: UTF-8, tab-width: 4 -*-
---

version: '3'
networks:
    default:
        type: 'bridge'
        driver_opts:
            'com.docker.network.bridge.name': 'br-ex01'

services:
    adminer_pg:
        image: 'adminer:4.8'
        environment:
            ADMINER_DEFAULT_DB_DRIVER: 'pgsql'
            ADMINER_DEFAULT_SERVER: 'postgres'
            ADMINER_DEFAULT_PORT: 5432
            ADMINER_DEFAULT_USER: 'postgres'
            ADMINER_DEFAULT_PASSWORD: 'example'
            ADMINER_DEFAULT_DB: ''
            ADMINER_PLUGINS: ''

        hostname: 'adminer-pg'
        restart: 'always'
        ports:
          - '127.0.0.1:5480:8080'

    debug_net_pyhttpd:
        image: 'python:3-alpine'
        restart: 'no'
        command: "sh -c '\n    apk add strace && strace -fyxttv -s 256 \\\n    python3 -m http.server --directory . 8080\n    '"
        working_dir: '/etc'
        hostname: 'debug-net-pyhttpd'
        ports:
          - '127.0.0.1:8087:8087'

    debug_nodejs:
        image: 'node:16'
        command: "sh -c 'date -R && sleep 9009009d'"
        working_dir: '/'
        hostname: 'debug-nodejs'
        restart: 'always'
        ports:
          - '127.0.0.1:2322:2322'
          - '127.0.0.1:2370:2370'
          - '127.0.0.1:2380:2380'

    mongodb:
        image: 'mongo:5'
        volumes:
          - '/…/docs/examples/ex01.devdock/@/mongo.data/v5:/data'

        restart: 'always'
        ports:
          - '127.0.0.1:27017:27017'

    postgres:
        image: 'postgres:14-alpine'
        volumes:
          - '/…/docs/examples/ex01.devdock/@/postgres.data/v14:/pgdata'

        shm_size: '32MB'
        environment:
            PGDATA: '/pgdata'
            POSTGRES_USER: 'postgres'
            POSTGRES_PASSWORD: 'example'

        restart: 'always'
        ports:
          - '127.0.0.1:5432:5432'

    rabbitmq:
        image: 'rabbitmq:3-management'
        volumes:
          - '/…/docs/examples/ex01.devdock/@/rabbitmq.data/v3:/var/lib/rabbitmq'
          - '/…/docs/examples/ex01.devdock/@/ssldebug-dummycert-pmb/ssldebug.pem:/ssldebug.pem:ro'

        environment:
            RABBITMQ_ERLANG_COOKIE: 'BiscuitBiscuitCrumbCrumb'

        restart: 'always'
        ports:
          - '127.0.0.1:5671:5671'
          - '127.0.0.1:5672:5672'
          - '127.0.0.1:15671:15671'
          - '127.0.0.1:15672:15672'

    redis_db:
        image: 'redis:alpine'
        volumes:
          - '/…/docs/examples/ex01.devdock/@/redis.data/v6:/data'

        command: 'redis-server,--save,--appendonly,yes'
        hostname: 'redis-db'
        restart: 'always'
        ports:
          - '127.0.0.1:6379:6379'

    redis_cmdr:
        image: 'rediscommander/redis-commander:latest'
        environment:
            REDIS_HOSTS: 'DevDock:redis-db:6379'

        hostname: 'redis-cmdr'
        restart: 'always'
        ports:
          - '127.0.0.1:6380:8081'

...
